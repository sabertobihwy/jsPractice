<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    html {
        scroll-behavior: smooth;
    }

    nav {
        position: fixed;
        left: 0;
    }


    nav ul li {
        list-style: none;
        /* width: 0vw; */

    }

    nav ul li a {
        text-decoration: none;
        color: black
    }

    div {
        position: absolute;
        width: 80vw;
        right: 0;
    }

    .hightlight {
        color: orange;
        font-size: large;
    }
</style>

<body>
    <nav>
        <ul>
            <li><a href="#section1">第一部分</a></li>
            <li><a href="#section2">第二部分</a></li>
            <li><a href="#section3">第三部分</a></li>
        </ul>
    </nav>

    <div>
        <section id="section1">
            <h2>第一部分</h2>
            <p>这是第一部分的内容。Lorem ipsum dolor sit amet consectetur, adipisicing elit. Nulla vel, porro aperiam tempore sunt
                est
                quos veniam architecto ipsa consectetur quae nesciunt, obcaecati consequuntur. Voluptatibus deleniti
                aliquid
                quibusdam dolorem reiciendis.
                Illo dignissimos est consectetur quibusdam laborum possimus ipsam? Pariatur esse eius dicta beatae
                dignissimos aperiam id necessitatibus quos nisi quisquam! Quas molestiae aliquam explicabo esse, dolore
                nostrum inventore excepturi recusandae.
                Consectetur eius incidunt sunt ullam placeat natus iusto explicabo reprehenderit tenetur fugiat eos est,
                sit
                animi? Sed quo illum, optio expedita commodi voluptatem vero magnam cupiditate quos. Magnam, quo
                eveniet.
                Voluptatum, omnis. Nobis iste quasi voluptates, hic repudiandae ab officiis voluptas sunt qui fuga
                temporibus repellat molestiae ratione, quas quidem. Recusandae iure porro enim voluptas dolore saepe
                perspiciatis dolores pariatur.
                Itaque, mollitia accusantium esse est ipsam nam quis quas a, molestias illo facilis aliquam ipsa ducimus
                id
                voluptates ex! Provident ea labore aliquam autem obcaecati hic nam deleniti esse quo.
                Neque quas enim est deserunt unde ea labore, quaerat doloribus magnam incidunt, illo nesciunt? Libero
                recusandae nobis, quae minima quibusdam soluta mollitia inventore voluptates similique laudantium, non
                veniam fuga quos!
                Aliquid blanditiis ipsam officiis cumque? Dolorem architecto voluptas natus similique sunt numquam rem
                officiis explicabo magni fugiat nostrum labore quaerat, a voluptatem ex deleniti voluptatum quasi
                aperiam.
                Ipsum, possimus illum.
                Et exercitationem nihil quae recusandae voluptate ea ullam, corporis, delectus dolore, accusamus porro
                laboriosam iste provident quos. Enim, assumenda incidunt. Sequi qui dicta hic alias quaerat quo fuga eos
                animi.
                Error vel recusandae nesciunt magnam officia tempora molestiae distinctio commodi cum iusto, accusantium
                eos
                illum non voluptas. Temporibus sit sequi dolores aliquam porro odio sint iure quibusdam placeat,
                adipisci
                exercitationem.
                Asperiores minus iste placeat corporis quidem dicta ab neque ad vero, soluta, repellendus minima animi
                praesentium! Sit minus earum minima porro unde corporis quia inventore ipsam esse. Nostrum, consectetur
                iste.
                Inventore excepturi, autem, accusamus assumenda non odio fuga dolores cupiditate, est eveniet aliquid!
                Voluptatibus odit blanditiis nobis ipsum similique facilis eos hic. Minima impedit amet rerum dicta in
                cumque itaque!
                Fuga minima necessitatibus itaque fugiat excepturi praesentium saepe ad ex ullam tempore, neque minus,
                vitae
                veritatis a delectus quis dolorum quod animi earum. Vel culpa repudiandae sit maiores facilis ut!
                Veritatis quisquam iste totam cum. Repellendus illum suscipit adipisci, autem dolores debitis minima
                sunt
                maxime, architecto corporis aliquam. Praesentium exercitationem suscipit optio illum quo fuga,
                consequuntur
                corrupti quia quisquam modi.
                Assumenda molestias soluta ut nobis similique, in corrupti at reprehenderit nihil praesentium dolorem.
                At
                officiis, alias necessitatibus iusto, ab maiores voluptatem iste nulla impedit expedita, odit aliquam
                itaque
                commodi inventore.
                Voluptates aspernatur similique possimus labore corrupti alias debitis est repellat dicta sed velit,
                facilis
                inventore sunt! Blanditiis aliquid, soluta totam vitae dolorum doloremque. Id ab corrupti minus commodi
                adipisci natus!
                Tempore voluptatem exercitationem ducimus illo! Ducimus, ullam sint id eum, pariatur officia esse nulla
                blanditiis animi at illum, expedita numquam voluptatibus necessitatibus quisquam architecto qui ratione
                sequi. Nesciunt, beatae nam!
                Impedit voluptas molestiae itaque autem molestias eum aperiam esse nemo dolore reprehenderit, recusandae
                magnam iste adipisci. Accusantium aliquid facere porro unde, dolorum vitae in ipsum laboriosam tempora
                corrupti sint voluptas?
                At fuga architecto eius placeat dicta, deleniti praesentium iusto, veritatis quam porro modi a dolorum
                nobis
                suscipit odit est! Voluptatum, laudantium fugiat! Repudiandae pariatur labore quam eligendi
                reprehenderit
                amet optio.
                Dolor blanditiis nulla repudiandae doloribus natus! Tempore delectus labore, quis similique eius
                sapiente
                nulla, obcaecati autem animi, odit excepturi quisquam sint voluptatem culpa. Dignissimos odit deleniti
                vitae
                accusamus natus veritatis.
                Voluptate quia architecto quo nemo nam repudiandae, ab eius! Explicabo id necessitatibus culpa nisi
                amet,
                dolores itaque officia dolorem ut magni molestiae modi, reprehenderit alias, doloremque quos voluptas
                eaque
                aspernatur.
                At saepe perspiciatis in harum placeat optio, explicabo possimus repellendus ullam. Ab blanditiis
                molestiae
                harum cumque? Obcaecati facilis, recusandae, dolores possimus maxime culpa aut aliquam voluptate
                voluptatem
                officiis harum voluptates!
                Deserunt tempore, veritatis laudantium, consequatur tempora et deleniti quidem voluptates iure provident
                mollitia vel. Maxime dolor fugit voluptatem, ex totam rem maiores, dignissimos iusto et ducimus,
                recusandae
                natus. Error, at.
                Eaque accusamus minus iure quaerat culpa sapiente, vitae est ipsa a ipsam fugiat numquam eum aliquam
                laboriosam? Iure ducimus, hic explicabo perferendis officia laboriosam dolore, ullam cumque ut esse
                nihil.
                Quod provident error, nesciunt tempore ratione dolorem sed porro quis commodi officia veritatis
                cupiditate
                quia, eos, deleniti nobis! In nam, autem voluptatibus officia mollitia expedita sint facilis obcaecati
                deserunt architecto.
                Exercitationem odit consequatur ratione ducimus dolor, accusantium, quidem eum hic dolorem ea provident
                neque! Ad, aperiam. Voluptatem error ea, odio doloremque, vero perspiciatis minima libero aliquid itaque
                odit, iste labore.
                Iure accusamus, adipisci inventore rem, dignissimos praesentium odio odit dolorem facilis officiis
                dolores
                temporibus pariatur voluptatibus natus sequi, debitis commodi aut? Aut, perspiciatis error modi illum
                veniam
                ex autem illo.
                Blanditiis voluptas adipisci illo assumenda vitae. Odio neque dolores quasi suscipit, laboriosam
                voluptatum
                nihil magni odit consequuntur doloribus ipsam tempore aspernatur animi. Sint iure possimus explicabo
                iste
                dolor ut aut?
                Sint veniam at aspernatur distinctio excepturi quisquam, sequi a, omnis, ducimus reprehenderit aliquam?
                Aspernatur magnam similique sed rem, explicabo suscipit vero delectus laborum blanditiis nam amet
                dolores
                sequi expedita doloremque?
                Dolore ipsum repudiandae et adipisci natus aliquam, eveniet cum praesentium totam saepe quasi veniam
                labore
                provident rerum corrupti illo qui, eum ut voluptate dolorum laboriosam nihil? Sunt culpa quod esse!
                Excepturi laborum reiciendis dolor sapiente dignissimos amet placeat repellendus suscipit id nulla ipsam
                culpa tempora incidunt sed, natus, temporibus fugiat eveniet, tenetur inventore maiores blanditiis.
                Laboriosam, aperiam quis. Cupiditate, aliquam.</p>
        </section>

        <section id="section2">
            <h2>第二部分</h2>
            <p>这是第二部分的内容。Lorem ipsum dolor sit amet, consectetur adipisicing elit. Pariatur numquam quo asperiores modi
                eos laboriosam facere molestiae tempore similique odio minima culpa aperiam sequi, error excepturi
                sapiente nihil, sit mollitia.
                Iste ad nihil debitis voluptate officiis! Laborum rerum dolorem ducimus ex, placeat dolor. Eum
                dignissimos facilis doloremque illo ullam dicta, sit nemo ipsam omnis aut fuga dolorem libero laudantium
                veniam?
                Numquam facere quasi esse maiores aspernatur error voluptas nisi sunt repellat modi eum nemo, ducimus
                voluptate fugiat rerum consequatur sit nihil. Repellendus saepe accusantium aspernatur temporibus id.
                Corrupti, molestias vel.
                Est impedit cupiditate nostrum rem deleniti officia numquam dolore illo laboriosam soluta aspernatur
                ratione deserunt harum fuga doloremque nemo animi veniam, ullam nulla. Similique numquam at inventore
                hic reprehenderit consequuntur.
                Ab enim repellat obcaecati ad molestias dignissimos pariatur quas, aliquam voluptatem! Sed temporibus
                natus, aspernatur iste dolorum, vero hic minima doloribus facilis nostrum ducimus laborum aliquid vitae.
                Doloribus, perspiciatis repudiandae.
                Dolore aspernatur minus iusto quibusdam rem, assumenda quidem iste dicta exercitationem laboriosam
                eveniet, officia esse omnis? Autem, recusandae aliquam! Esse laborum consectetur consequuntur quibusdam
                fugit omnis, repudiandae voluptatibus reiciendis rem?
                Enim porro voluptatum rem ipsa temporibus quidem, accusantium nemo dicta aperiam officia sint nam
                voluptas saepe magni rerum cumque ipsum ullam. Dignissimos, laudantium hic! Laborum, vitae. Nisi iusto
                pariatur minus.
                Distinctio debitis vel ex necessitatibus culpa officia! Repellendus accusamus aperiam quae architecto
                repudiandae incidunt esse doloribus saepe minus! Similique atque maxime ducimus, distinctio possimus rem
                non voluptatum aliquid molestias ullam!
                Officiis ipsa consequatur repellendus, reprehenderit quasi accusamus pariatur aperiam soluta quia,
                adipisci id esse ea quos earum sequi hic eaque rem incidunt magnam, assumenda debitis vero mollitia.
                Quam, obcaecati dolor!
                Atque cum distinctio nihil blanditiis ut dignissimos! Voluptate, sint cum! Iure facilis suscipit qui
                sunt culpa temporibus non voluptate distinctio. Magni facilis perferendis dolores deserunt ipsam
                reiciendis eos unde veritatis?
                Dolorum nemo modi consectetur eos sapiente impedit, repellat non iste numquam tenetur possimus
                asperiores nobis consequatur ex, eligendi fugiat illum, sunt ab. Nesciunt ullam rem officia. Ratione
                obcaecati quos harum!
                Assumenda nihil officia praesentium dolorem neque qui alias omnis eaque autem quae voluptatum in, dicta
                harum molestias, mollitia repudiandae magnam et asperiores pariatur at molestiae. Veritatis quod aliquid
                voluptatibus excepturi?
                Facilis rerum maiores quasi architecto exercitationem. Fugiat exercitationem in dolores accusamus esse
                iusto nisi labore nesciunt officia consequuntur architecto nemo magnam, quisquam ipsa! Velit aut quae,
                qui ab laborum ut!
                Doloribus eligendi quidem voluptate quod veritatis, recusandae autem illo voluptatem perferendis
                voluptatum corrupti error quaerat aliquam tenetur tempora blanditiis optio quam dolor veniam a,
                consectetur quibusdam repudiandae fuga atque! Excepturi?
                Id, deleniti praesentium perferendis ipsam rerum nam vitae repudiandae assumenda suscipit soluta
                temporibus deserunt laboriosam mollitia ab harum, inventore ullam voluptatibus minima quo ut maiores
                cum. Quasi corrupti fugit culpa.
                Sed quis tempora, fugiat repudiandae ducimus iusto officiis omnis? Commodi non aliquam, voluptatem,
                iusto tempore adipisci consequatur officiis magnam pariatur blanditiis atque cumque animi vitae cum nemo
                debitis velit aliquid!
                Laudantium doloribus odit eligendi nihil quaerat officiis sed iure a explicabo eaque quasi quis quos
                voluptatibus quae delectus accusamus, aut facere laboriosam nam. Commodi suscipit veritatis facilis!
                Dolores, rerum eaque.
                Cupiditate autem quia quis inventore et vel earum nihil quidem alias laboriosam id minima saepe, harum
                temporibus ea voluptatibus. Nihil veritatis reiciendis autem eos animi assumenda voluptatum suscipit,
                molestias sequi?
                Eius voluptas accusamus ad amet a distinctio suscipit dolores unde autem temporibus, veniam dignissimos
                dolore obcaecati tenetur officia animi omnis error velit? Similique asperiores rem at exercitationem
                sit, fugiat ullam.
                Animi aliquam quae consequuntur minima voluptatem pariatur neque sunt ut sed. Id ducimus repudiandae
                iure expedita quidem, hic blanditiis esse eveniet velit labore aperiam cum aliquam natus odio debitis!
                Dolores?</p>
        </section>

        <section id="section3">
            <h2>第三部分</h2>
            <p>这是第三部分的内容。Lorem, ipsum dolor sit amet consectetur adipisicing elit. Rem at repudiandae, adipisci, itaque
                nam, dolorum dolore earum quod molestias alias recusandae saepe id eum et totam asperiores vero aut hic!
            </p>
        </section>
    </div>

</body>
<script src="./hightlight.js"></script>
<script>
    const titles = document.querySelectorAll('a[href^="#"]')
    const sections = []
    titles.forEach(a => {
        const id = a.href
        const url = new URL(id)
        const section = document.querySelector(url.hash)
        if (section) {
            sections.push(section)
        }
        a.addEventListener('click', (e) => {
            hightlight(url.hash)
        })
    })

    function debounce(fn, delay) {
        let id;
        return function (...args) {
            clearTimeout(id)
            id = setTimeout(() => fn(...args), delay)
        }
    }
    const ch = document.documentElement.clientHeight
    const scrollHandler = debounce(() => {
        const rects = sections.map(sec => sec.getBoundingClientRect())
        rects.forEach((rect, index) => {
            if (rect.top > 0 && rect.top <= ch * 0.3) {
                hightlight(titles[index])
            }
            if (rect.top < 0 && rects[index + 1].top > ch) {
                hightlight(titles[index])
            }
            if (rect.top < ch && (index === rects.length - 1)) {
                hightlight(titles[index])
            }
        })
    }, 500)
    window.addEventListener('scroll', scrollHandler)

</script>

</html>